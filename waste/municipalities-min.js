var MOE_map_language="EN";var isMobile=false;mapConfig=(function(){var c=49.764775;var s=-85.323214;var f=5;var p=5;var o=21;var w=true;var t=MOE_map_language;var h="http://www.camaps.ca/ArcGIS/rest/services/SportFish/SportFish/MapServer";var q=[0,1,2];var v=[0];var y=false;var g="";var x=[{label:"Information",content:"<div style=\"width:300px;height:120px;overflow:auto;font-size:small\"><b><font color='#799441'>{LOCNAME_"+MOE_map_language+"}</font></b><br>{GUIDELOC_"+MOE_map_language+"}<img height=1 width=300 src='http://www.downloads.ene.gov.on.ca/en/publications/dataproducts/images/MOE_Mapping_Library_Black.jpg' /><br><a target='_blank' href='{URL_"+MOE_map_language+"}'>Consumption Advisory Table</a><br><br>Latitude <b>{MOEMAP_TOOLS.deciToDegree(LATITUDE)}</b> Longitude <b>{MOEMAP_TOOLS.deciToDegree(LONGITUDE)}</b><br><a href='mailto:sportfish.moe@ontario.ca?subject=Portal Error (Submission {LOCNAME_"+MOE_map_language+"})'>Report an error for this location</a>.</div>"}];var k=["LOCNAME_"+MOE_map_language,"LATITUDE","LONGITUDE","GUIDELOC_"+MOE_map_language,"URL_"+MOE_map_language];function m(){var z=document.getElementById("map_query").value.trim();if(z.length===0){return}MESSAGE.messageStartSearching();MOEMap.queryLayerWithLocator(z)}function j(D,C,B){if(D.length===0){return}MESSAGE.messageStartSearching();g=D;y=C;if(B){var A=D.split(/\s+/);var E=A.join(" ").toUpperCase();MOEMap.queryLayerWithLocator("UPPER(LOCNAME_"+MOE_map_language+") LIKE '%"+E+"%'")}else{var z=r(D);g=z.information;MOEMap.queryLayerWithoutLocator(z.condition)}}function e(F){var z={GERMAN_TROUT:["BROWN_TROUT"],SHEEPHEAD:["FRESHWATER_DRUM"],STEELHEAD:["RAINBOW_TROUT"],SUNFISH:["PUMPKINSEED"],BARBOTTE:["BROWN_BULLHEAD"],BLACK_BASS:["LARGEMOUTH_BASS","SMALLMOUTH_BASS"],CALICO_BASS:["BLACK_CRAPPIE"],CRAWPIE:["BLACK_CRAPPIE","WHITE_CRAPPIE"],GREY_TROUT:["LAKE_TROUT"],HUMPBACK_SALMON:["PINK_SALMON"],KING_SALMON:["CHINOOK_SALMON"],LAKER:["LAKE_TROUT"],MENOMINEE:["ROUND_WHITEFISH"],MUDCAT:["BROWN_BULLHEAD"],MULLET:["WHITE_SUCKER"],PANFISH:["BLUEGILL","ROCK_BASS","PUMPKINSEED"],PICKEREL:["WALLEYE"],SILVER_BASS:["WHITE_BASS"],SILVER_SALMON:["COHO_SALMON"],SPECKLED_TROUT:["BROOK_TROUT"],SPRING_SALMON:["CHINOOK_SALMON"]};var B=z[F];var E=MOEMAP_TOOLS.wordCapitalize(MOEMAP_TOOLS.replaceChar(F,"_"," "));if(typeof(B)=="undefined"){var H={condition:"(SPECIES_"+MOE_map_language+" like '%"+F+"%')",information:E};return H}else{var C=[];var G=[];for(var A=0;A<B.length;A++){C.push("(SPECIES_"+MOE_map_language+" like '%"+B[A]+"%')");var D=MOEMAP_TOOLS.wordCapitalize(MOEMAP_TOOLS.replaceChar(B[A],"_"," "));G.push(D.trim())}var H={condition:"("+C.join(" OR ")+")",information:E+" ("+G.join(", ")+")"};return H}}function r(z){var F=z.toUpperCase();F=MOEMAP_TOOLS.replaceChar(F,"&",", ");F=MOEMAP_TOOLS.replaceChar(F," AND ",", ");F=F.trim();var E=F.split(",");var G=E.length;var D=[];var H=[];for(var C=0;C<G;C++){var B=(E[C]).trim();if(B.length>0){var A=B.split(/\s+/);B=A.join("_");var I=e(B);D.push(I.condition);H.push(I.information)}}var J={condition:D.join(" AND "),information:H.join(", ")};return J}function u(){}function b(){var z={zoom:f,center:new google.maps.LatLng(c,s),mapTypeId:google.maps.MapTypeId.ROADMAP,draggableCursor:"pointer",minZoom:p,maxZoom:o,streetViewControl:true};return new google.maps.Map(document.getElementById("map_canvas"),z)}function n(z){if(!isMobile){document.getElementById("information").innerHTML=z}}function d(C){var B=C.latLng;var D=B.lat();var z=B.lng();var A=MOEMAP_TOOLS.convertLatLngtoUTM(D,z);if(!isMobile){if(mapConfig.language=="EN"){document.getElementById("coordinates").innerHTML="Latitude:"+D.toFixed(6)+", Longitude:"+z.toFixed(6)+" (UTM Zone:"+A.Zone+", Easting:"+A.Easting+", Northing:"+A.Northing+")"}else{document.getElementById("coordinates").innerHTML="Latitude:"+D.toFixed(6)+", Longitude:"+z.toFixed(6)+" (Zone UTM:"+A.Zone+", abscisse:"+A.Easting+", ordonn\u00e8e:"+A.Northing+")"}}}function l(B){var A=document.createElement("div");var z=new goog.ui.TabBar();for(i=0;i<B.length;i++){var D=new goog.ui.Tab(B[i].label);D.content=B[i].content;z.addChild(D,true)}A.style.width="450px";z.render(A);goog.dom.appendChild(A,goog.dom.createDom("div",{"class":"goog-tab-bar-clear"}));var C=goog.dom.createDom("div",{"class":"goog-tab-content"});goog.dom.appendChild(A,C);goog.events.listen(z,goog.ui.Component.EventType.SELECT,function(E){C.innerHTML=E.target.content});z.setSelectedTabIndex(0);return A}var a={orgLatitude:c,orgLongitude:s,orgzoomLevel:f,minMapScale:p,maxMapScale:o,coor_Status:w,language:t,url:h,visibleLayerIds:q,layerIds:v,withinExtent:y,address:g,tabs:x,outFields:k,search:m,init:u,searchWithParameters:j,initGoogleMap:b,message:n,mouseMove:d,multipleTabsPopup:l};return a})();if(!isMobile){window.onload=function(){MOEMap.init()}}var MOEMapGlobalConfig={boundaryPolygon:[{x:-95.2992035,y:48.77505703},{x:-95.2992035,y:53.07150598},{x:-89.02502409,y:56.9587693},{x:-87.42238044,y:56.34499088},{x:-86.3653176,y:55.93580527},{x:-84.69447635,y:55.45842206},{x:-81.89837466,y:55.35612565},{x:-81.96657226,y:53.17380238},{x:-80.84131182,y:52.28723355},{x:-79.98884179,y:51.80985033},{x:-79.34096457,y:51.74165273},{x:-79.34096457,y:47.54750019},{x:-78.55669214,y:46.49043736},{x:-76.61306048,y:46.14944935},{x:-75.59009645,y:45.77436253},{x:-74.123848,y:45.91075774},{x:-73.98745279,y:45.02418891},{x:-75.07861443,y:44.61500329},{x:-75.86288685,y:44.03532368},{x:-76.88585089,y:43.69433566},{x:-79.2,y:43.450196},{x:-78.62488975,y:42.94416204},{x:-79.54555738,y:42.43268002},{x:-81.28459623,y:42.15988961},{x:-82.54625188,y:41.58020999},{x:-83.2623267,y:41.95529681},{x:-83.3646231,y:42.43268002},{x:-82.61444948,y:42.73956923},{x:-82.17116506,y:43.59203926},{x:-82.61444948,y:45.36517692},{x:-84.08069793,y:45.91075774},{x:-84.93316796,y:46.69503016},{x:-88.27485047,y:48.22947621},{x:-89.3319133,y:47.7861918},{x:-90.32077854,y:47.6838954},{x:-92.09391619,y:47.95668581},{x:-94.07164666,y:48.33177262},{x:-95.2992035,y:48.77505703}],GeogTwpService:"http://www.camaps.ca/ArcGIS/rest/services/SportFish/Geog_TWP/MapServer",maxQueryReturn:500,predefinedLevel:11};MOEMAP_TOOLS=(function(){var h=["JANUARY","FEBRUARY","MARCH","APRIL","MAY","JUNE","JULY","AUGUST","SEPTEMBER","OCTOBER","NOVEMBER","DECEMBER"],b=["JANVIER","FEVRIER","MARS","AVRIL","MAI","JUIN","JUILLET","AOUT","SEPTEMBRE","OCTOBRE","NOVEMBRE","DECEMBRE"],o=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],e=["01","02","03","04","05","06","07","08","09","10","11","12"];function s(x,u){var v=-1;for(var w=0;w<u.length;w++){if(u[w]==x){v=w;break}}return v}function m(w){var u=w.trim().split(" ");for(var v=0;v<u.length;v++){u[v]=u[v].substring(0,1).toUpperCase()+u[v].substring(1,u[v].length).toLowerCase()}return u.join(" ")}function t(u){if(typeof(u)=="undefined"){return"N/A"}if(u=="null"){return"N/A"}if(u=="Null"){return"N/A"}return u}function p(z,w,v){var x=[];x=z.split(w);var u=x[0];if(x.length>=2){for(var y=1;y<x.length;y++){u=u+v+x[y]}}return u}function a(z){var v="N";if(z<0){z=-z;if(mapConfig.language=="EN"){v="W"}else{v="O"}}var y=Math.floor(z);var u=(z-y)*60;var A=Math.floor(u);var w=Math.floor((u-A)*60);var x="";if(w<1){x=""+y+"&deg;"+A+"'"}else{if(w>58){x=""+y+"&deg;"+(A+1)+"'"}else{x=""+y+"&deg;"+A+"'"+w+'"'}}return x+v}function j(A,y){if(A.length>0){for(var v=0;v<A.length;v++){var z=A[v].getPath();var u=z.getLength();for(var w=0;w<u;w++){if(y.contains(z.getAt(w))){return true}}}}return false}function n(C,ae){var W=3.14159265358979;var Y=6378137;var J=0.9996;var U=0.081819191;var w=0.006694380015894481;var u=6367449.146;var O=16038.42955;var T=16.83261333;var v=0.021984404;var Q=0.000312705;var V=31+Math.floor(ae/6);var z=C*W/180;var P=Math.sin(z);var M=U*P*U*P;var K=Math.cos(z);var I=Math.tan(z);var aa=Y/(Math.sqrt(1-M));var A=u*z-O*Math.sin(2*z)+T*Math.sin(4*z)-v*Math.sin(6*z)+Q*Math.sin(8*z);var H=A*J;var G=aa*P*K*J/2;var F=((aa*P*M*M*M)/24)*(5-I*I+9*w*K*K+4*w*w*K*K*K*K)*J;var D=aa*K*J;var B=K*K*K*(aa/6)*(1-I*I+w*K*K)*J;var E=6*V-183;var ad=(ae-E)*W/180;var ab=ad*ad;var Z=ab*ad;var X=Z*ad;var N=500000+(D*ad+B*Z);var R=(H+G*ab+F*X);var L=R;if(L<0){L=L+10000000}var ac={Zone:V,Easting:N.toFixed(2),Northing:L.toFixed(2)};return ac}function k(J,L,O){var M=3.14159265358979;var aq=6378137;var T=0.9996;var ao=0.081819191;var ak=0.006694380015894481;var B=500000-O;var N=L/T;var aj=ak*ak;var ai=aj*ak;var ae=Math.sqrt(1-ak);var Q=(1-ae)/(1+ae);var I=Q*Q;var G=I*Q;var F=G*Q;var aa=3*Q/2-27*G/32;var X=21*I/16-55*F/32;var W=151*G/96;var U=1097*F/512;var C=N/(aq*(1-ak/4-3*aj/64-5*ai/256));var ah=C+aa*Math.sin(2*C)+X*Math.sin(4*C)+W*Math.sin(6*C)+U*Math.sin(8*C);var am=Math.cos(ah);var P=Math.tan(ah);var A=P*P;var u=Math.sin(ah);var an=ao*u;var ab=1-an*an;var Y=Math.sqrt(ab);var v=aq/Y;var ag=aq*(1-ak)/(ab*Y);var K=B/(v*T);var V=K*K;var S=V*V;var R=S*V;var z=v*P/ag;var y=V/2;var x=(5+3*A+10*aa-4*aa*aa-9*ak)*S/24;var w=(61+90*A+298*aa+45*A*A-252*ak-3*aa*aa)*R/720;var af=K;var ad=(1+2*A+aa)*V*K/6;var Z=(5-2*aa+28*A-3*aa*aa+8*ak+24*A*A)*S*K/120;var ap=(af-ad+Z)/am;var H=6*J-183;var E=180*(ah-z*(y+x+w))/M;var al=H-ap*180/M;var ac={Latitude:E.toFixed(8),Longitude:al.toFixed(8)};return ac}function g(y,B){var A=B;if(B>0){A=-A}var u=MOEMapGlobalConfig.boundaryPolygon;var z=u.length;var v=false;var w=z-1;for(var x=0;x<z;x++){var D=u[x];var C=u[w];if(D.x<A&&C.x>=A||C.x<A&&D.x>=A){if(D.y+(A-D.x)/(C.x-D.x)*(C.y-D.y)<y){v=!v}}w=x}return v}function l(C,B){var y=C.lat();var A=C.lng();var x=B.getPath();var z=x.length;var u=false;var v=z-1;for(var w=0;w<z;w++){var E=x.getAt(w);var D=x.getAt(v);if(E.lng()<A&&D.lng()>=A||D.lng()<A&&E.lng()>=A){if(E.lat()+(A-E.lng())/(D.lng()-E.lng())*(D.lat()-E.lat())<y){u=!u}}v=w}return u}function d(y,x){var u=258030.3;var v=741969.7;var z=4614583.73;var w=6302884.09;return((y<v)&&(y>u)&&(x<w)&&(x>z))}function q(){var v=/^(-?\d+)(\.\d+)?$/;for(var u=0;u<arguments.length;u++){if(!v.test(arguments[u])){return false}}return true}function f(v,u){if(g(v,u)){return{latLng:new google.maps.LatLng(v,u),success:true}}else{return r()}}function r(){return{success:false}}var c={getArrayIndex:s,wordCapitalize:m,processNA:t,replaceChar:p,deciToDegree:a,isPolylineListWithinBounds:j,convertLatLngtoUTM:n,convertUTMtoLatLng:k,isInPolygon:g,isWithinPolygon:l,isInPolygonUTM:d,isAllFloat:q,validateLatLng:f,locatorFailed:r};return c})();TABS_CALCULATOR=(function(){function getContent(attributes,tabs){var contents=[];for(var i=0;i<tabs.length;i++){var tab=tabs[i];var tabName=getInfoWindowContent(attributes,tab.label);if(tabName.trim().length>1){var tabContent=getInfoWindowContent(attributes,tab.content);contents.push({label:tabName,content:tabContent})}}return contents}function getInfoWindowContent(attributes,infoWindowString){var start=infoWindowString.indexOf("[");var end=infoWindowString.indexOf("]");if((start>=0)&&(end>=0)){infoWindowString=removeConditionInfoWindow(infoWindowString,attributes,start,end)}start=infoWindowString.indexOf("{");end=infoWindowString.indexOf("}");if((start>=0)&&(end>=0)){infoWindowString=getInfoWindowString(infoWindowString,attributes,start,end)}return infoWindowString}function removeConditionInfoWindow(infoWindowString,attributes,start,end){var str1=infoWindowString.substring(0,start);var str2=infoWindowString.substring(start+1,end);var str3=infoWindowString.substring(end+1);var index=str2.indexOf("}");var fieldName=str2.substring(1,index);var str4=str2.substring(index+2);index=str4.indexOf("?");var result="";if(attributes[fieldName]>0){result=str1+str4.substring(index+1)}else{result=str1+str4.substring(0,index)}var start1=str3.indexOf("[");var end1=str3.indexOf("]");if((start1>=0)&&(end1>=0)){str3=removeConditionInfoWindow(str3,attributes,start1,end1)}result=result+str3;return result}function getInfoWindowString(infoWindowString,attributes,start,end){var str1=infoWindowString.substring(0,start);var fieldName=infoWindowString.substring(start+1,end);var str3=infoWindowString.substring(end+1);var dataStr=" ";var funStart=fieldName.indexOf("(");var funEnd=fieldName.indexOf(")");if((funStart>=0)&&(funEnd>=0)){var funName=fieldName.substring(0,funStart);var parameters=fieldName.substring(funStart+1,funEnd);var paraArray=parameters.split(",");funName=funName+"(";for(var j=0;j<paraArray.length;j++){if((paraArray[j]).indexOf("'")==-1){var attrValue=attributes[paraArray[j]];if(typeof attrValue=="number"){funName=funName+attrValue}if(typeof attrValue=="string"){if(attrValue.indexOf("'")==-1){funName=funName+"'"+attrValue+"'"}else{if(attrValue.indexOf('"')==-1){funName=funName+'"'+attrValue+'"'}else{funName=funName+'"'+attrValue.replace('"','"')+'"'}}}}else{funName=funName+paraArray[j]}if(j<paraArray.length-1){funName=funName+","}}funName=funName+");";dataStr=eval(funName)}else{if(attributes[fieldName]!="Null"){dataStr=attributes[fieldName]}}var start1=str3.indexOf("{");var end1=str3.indexOf("}");if((start1>=0)&&(end1>=0)){str3=getInfoWindowString(str3,attributes,start1,end1)}var result=str1+dataStr+str3;return result}var module={getContent:getContent};return module})();MESSAGE=(function(){function e(h){mapConfig.message(h)}function a(){var h="";if(mapConfig.language=="EN"){if(mapConfig.withinExtent){h="in the current map display"}else{h="in Ontario"}}else{if(mapConfig.withinExtent){h="dans l'affichage actuel de la carte"}else{h="en Ontario"}}return h}function f(){var h=a();if(mapConfig.language=="EN"){e("<i>1 result found for <b>"+mapConfig.address+"</b> "+h+".</i>")}else{e("<i>1 r\u00e9sultat pour <b>"+mapConfig.address+"</b> "+h+".</i>")}document.forms.formLocation.submit()}function g(){var h=a();if(mapConfig.language=="EN"){e("<i>Your search for <b>"+mapConfig.address+"</b> returned no result "+h+".</i>")}else{e("<i>Votre recherche pour <b>"+mapConfig.address+"</b> n'a donn\u00e9 aucun r\u00e9sultat "+h+".</i>")}}function b(){if(mapConfig.language=="EN"){e("<i>Searching Address</i>")}else{e("<i>Recherche des r\u00e9sultats ...</i>")}}function d(h){var j=a();if(h===0){if(mapConfig.language=="EN"){e("<i>Your search for <b>"+mapConfig.address+"</b> returned no result "+j+".</i>")}else{e("<i>Votre recherche pour <b>"+mapConfig.address+"</b> n'a donn\u00e9 aucun r\u00e9sultat "+j+".</i>")}return}if(h==1){if(mapConfig.language=="EN"){e("<i>1 result found for <b>"+mapConfig.address+"</b> "+j+".</i>")}else{e("<i>1 r\u00e9sultat pour <b>"+mapConfig.address+"</b> "+j+".</i>")}return}if(h>=MOEMapGlobalConfig.maxQueryReturn){if(mapConfig.language=="EN"){e("<i>More than "+MOEMapGlobalConfig.maxQueryReturn+" results found for <b>"+mapConfig.address+"</b> "+j+". Only "+MOEMapGlobalConfig.maxQueryReturn+" returned.</i>")}else{e("<i>Plus de "+MOEMapGlobalConfig.maxQueryReturn+" r\u00e9sultats pour <b>"+mapConfig.address+"</b> "+j+". Seulement 500 retourn\u00e9s.</i>")}return}if(mapConfig.language=="EN"){e("<i>"+h+" results found for <b>"+mapConfig.address+"</b> "+j+".</i>")}else{e("<i>"+h+" r\u00e9sultats pour <b>"+mapConfig.address+"</b> "+j+".</i>")}}var c={messageStartSearching:b,locatorSucceed:f,locatorFailed:g,messageSearch:d};return c})();LATLNG_LOCATOR=(function(){function g(j){if(j.length!=2){return MOEMAP_TOOLS.locatorFailed()}var k=a(j);if(!k.success){k=h(j)}if(!k.success){k=b(j)}if(k.success){MOEMap.locateMap(k.latLng,14,mapConfig.address)}return k}function a(j){if(MOEMAP_TOOLS.isAllFloat(j[0],j[1])){var n=Math.abs(parseFloat(j[0]));var m=Math.abs(parseFloat(j[1]));var l=Math.min(n,m);var k=-Math.max(n,m);return MOEMAP_TOOLS.validateLatLng(l,k)}else{return MOEMAP_TOOLS.locatorFailed()}}function h(j){var m=String.fromCharCode(176);if(((j[0]).indexOf(m)>0)&&((j[1]).indexOf(m)>0)){v1=d(j[0],m,"'",'"');v2=d(j[1],m,"'",'"');var l=Math.min(v1,v2);var k=-Math.max(v1,v2);return MOEMAP_TOOLS.validateLatLng(l,k)}else{return MOEMAP_TOOLS.locatorFailed()}}function b(j){var n=(j[0]).toUpperCase();var m=(j[1]).toUpperCase();var l=e(n)*e(m);if(l>0){v1=d(n,"D","M","S");v2=d(m,"D","M","S");var o=Math.min(v1,v2);var k=-Math.max(v1,v2);return MOEMAP_TOOLS.validateLatLng(o,k)}else{return MOEMAP_TOOLS.locatorFailed()}}function e(k){for(var j=0;j<=9;j++){if(k.indexOf(j+"D")>0){return 1}}return 0}function d(k,q,p,o){var r=0;var n=f(q,k);var j=n.ParsedNum;n=f(p,n.Unparsed);var l=n.ParsedNum;n=f(o,n.Unparsed);var m=n.ParsedNum;if(j>0){r=j+l/60+m/3600}else{r=j-l/60-m/3600}r=Math.abs(r);return r}function f(n,m){var l={ParsedNum:0,Unparsed:""};if(m.length===0){return l}var k=m.split(n);var j=0;if(k.length<=2){if(MOEMAP_TOOLS.isAllFloat(k[0])){j=parseFloat(k[0])}if(k.length==2){m=k[1]}else{m=""}}l={ParsedNum:j,Unparsed:m};return l}var c={process:g};return c})();UTM_LOCATOR=(function(){function c(e){var f=b(e);if(!f.success){f=d(e)}if(f.success){MOEMap.locateMap(f.latLng,14,mapConfig.address)}return f}function b(e){if(e.length!=2){return MOEMAP_TOOLS.locatorFailed()}if(MOEMAP_TOOLS.isAllFloat(e[0],e[1])){var k=Math.abs(parseFloat(e[0]));var h=Math.abs(parseFloat(e[1]));var g=Math.min(k,h);var f=Math.max(k,h);if(MOEMAP_TOOLS.isInPolygonUTM(g,f)){var j=MOEMAP_TOOLS.convertUTMtoLatLng(17,f,g);return MOEMAP_TOOLS.validateLatLng(j.Latitude,j.Longitude)}else{return MOEMAP_TOOLS.locatorFailed()}}else{return MOEMAP_TOOLS.locatorFailed()}}function d(j){var k=MOEMAP_TOOLS.locatorFailed();if(j.length!=3){return k}var g=(j[0]).replace(","," ").trim();var f=(j[1]).replace(","," ").trim();var e=(j[2]).replace(","," ").trim();if(MOEMAP_TOOLS.isAllFloat(g,f,e)){var l=[Math.abs(parseFloat(g)),Math.abs(parseFloat(f)),Math.abs(parseFloat(e))];l.sort(function(p,o){return p-o});var m=(l[0]).toString();var n=/^\d+$/;if(n.test(m)){if((l[0]>=15)&&(l[0]<=18)){if(MOEMAP_TOOLS.isInPolygonUTM(l[1],l[2])){var h=MOEMAP_TOOLS.convertUTMtoLatLng(l[0],l[2],l[1]);return MOEMAP_TOOLS.validateLatLng(h.Latitude,h.Longitude)}}}}return k}var a={process:c};return a})();TWP_LOCATOR=(function(){function d(j){var l=j.join(" ").toUpperCase();var m=f(l);if(m.success){var h=e(m);var n={returnGeometry:true,outFields:["CENX","CENY"]};var g;if(m.isTWPOnly){n.where="NAME = '"+m.TWP+"'";g=0}else{n.where="OFFICIAL_NAME_UPPER = '"+m.TWP+"' AND CONCESSION_NUMBER = 'CON "+m.Con+"' AND LOT_NUM_1 = 'LOT "+m.Lot+"'";g=1}var k=new gmaps.ags.Layer(MOEMapGlobalConfig.GeogTwpService+"/"+g);k.query(n,function(o){if(o.features.length>0){MOEMap.locateMap(a(o),h.level,h.content)}});return{success:true}}else{return MOEMAP_TOOLS.locatorFailed()}}function f(l){var k={TWP:"",Lot:"",Con:"",isTWPOnly:false,success:false};if(l.indexOf(" TWP")>0){k=b(l.split(" TWP"))}if(!k.success){if(l.indexOf(" TOWNSHIP")>0){k=b(l.split(" TOWNSHIP"))}}if(!k.success){if(l.indexOf("CANTON ")===0){var n=l.substring(7).trim();var j=n.indexOf(" LOT ");var g=n.indexOf(" CON ");var h=j;if(g<j){h=g}var m=[];if(h===-1){m.push(n);m.push("")}else{m.push(n.substring(0,h));m.push(n.substring(h))}k=b(m)}}return k}function b(m){if(m.length!=2){return{TWP:"",Lot:"",Con:"",isTWPOnly:false,success:false}}var o=(m[0]).trim().split(/\s+/).join(" ");var j="";var l="";if(((m[1]).indexOf("LOT")>0)&&((m[1]).indexOf("CON")>0)){var k=((m[1]).trim()).split("CON");if((k[0]).length===0){var h=(k[1]).split("LOT");j=(h[0]).trim();l=(h[1]).trim()}else{var g=(k[0]).split("LOT");j=(k[1]).trim();l=(g[1]).trim()}}var n=false;if((j.length===0)&&(l.length===0)){n=true}return{TWP:o,Lot:l,Con:j,isTWPOnly:n,success:true}}function e(h){var g="";var j=14;if(h.isTWPOnly){j=11;if(mapConfig.language=="EN"){g=MOEMAP_TOOLS.wordCapitalize(h.TWP)+" Township"}else{g="Canton "+MOEMAP_TOOLS.wordCapitalize(h.TWP)}}else{if(mapConfig.language=="EN"){g=MOEMAP_TOOLS.wordCapitalize(h.TWP)+" Township, Con "+h.Con+", Lot "+h.Lot}else{g="Canton "+MOEMAP_TOOLS.wordCapitalize(h.TWP)+", Con "+h.Con+", Lot "+h.Lot}}return{content:g,level:j}}function a(j){var l=0;var k=0;var p=0;for(var o=0;o<j.features.length;o++){var n=j.features[o].attributes;var h=0;for(var g=0;g<j.features[o].geometry.length;g++){var m=j.features[o].geometry[g];h=h+google.maps.geometry.spherical.computeArea(m.getPath());MOEMap.addPolyline(m)}k=k+(n.CENY*h);l=l+(n.CENX*h);p=p+h}return new google.maps.LatLng(k/p,l/p)}var c={process:d};return c})();ADDRESS_LOCATOR=(function(){function d(f){var h=new google.maps.Geocoder();var g=f;if(!c(g)){g=g+" Ontario"}h.geocode({address:g},e)}function c(h){var f=h.toUpperCase();var g=a(f,"ON");if(!g){g=a(f,"ONT")}if(!g){g=a(f,"ONTARIO")}return g}function a(f,h){if(f.length>h.length+1){var g=f.substring(f.length-h.length-1);if(g==(" "+h)||g==(","+h)){return true}}return false}function e(l,h){if(h==google.maps.GeocoderStatus.OK){var g=l.length;var k=true;for(var j=0;j<g;j++){var f=l[j].geometry.location;if(MOEMAP_TOOLS.isInPolygon(f.lat(),f.lng())){MOEMap.locateMap(f,12,l[j].formatted_address);k=false;break}}if(k){MESSAGE.locatorFailed()}}else{MESSAGE.locatorFailed()}}var b={process:d};return b})();LOCATOR=(function(){function b(c){var f=MOEMAP_TOOLS.replaceChar(c,","," ");var d=f.split(/\s+/);var e=LATLNG_LOCATOR.process(d);if(!e.success){e=UTM_LOCATOR.process(d)}if(!e.success){e=TWP_LOCATOR.process(d)}if(!e.success){e=ADDRESS_LOCATOR.process(c)}}var a={locate:b};return a})();MOEMap=(function(){var e,c;var t=new google.maps.InfoWindow({content:""});var m=null;var x=[];var k=[];function p(){if(!("trim" in String.prototype)){String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}}Array.prototype.contains=function(A){for(var z=0;z<this.length;z++){if(this[z]==A){return true}}return false}}function o(z){mapConfig.init();p();if(typeof z=="undefined"){e=mapConfig.initGoogleMap()}else{e=z}}function q(z){if(z&&z.which==13){mapConfig.search()}else{return true}}function v(){}function g(B,D,C){var A=new gmaps.ags.MapService("http://www.appliomaps.lrc.gov.on.ca/ArcGIS/rest/services/MOE/waste/MapServer");var z=[0,1,2];A.identify({geometry:B,tolerance:1,layerIds:z,layerOption:"all",bounds:e.getBounds(),width:e.getDiv().offsetWidth,height:e.getDiv().offsetHeight},function(F,G){if(G){alert(G.message+G.details.join("\n"))}else{var I=/[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ]( )?\d[ABCEGHJKLMNPRSTVWXYZ]\d/;var E=D.search(I);var H=D.substring(E,E+7);H=H.replace(" ","");if(E==-1){document.getElementById("postal_field").value=""}else{document.getElementById("postal_field").value=H}h(F,B,D,C)}})}function y(z,B){for(var A=0;A<B.length;A++){var C=(B[A]).feature.geometry[0];if(MOEMAP_TOOLS.isWithinPolygon(z,C)){return A}}return 0}function u(C,z,D){if(D.length===0){return""}var B=0;if(D.length>1){B=y(z,D)}var E=(D[B]).feature.geometry[0];var A=(D[B]).feature.attributes;j(C,MOEMAP_TOOLS.wordCapitalize(A.LEGAL_NAME));return C+" <strong>"+MOEMAP_TOOLS.wordCapitalize(A.LEGAL_NAME)+"</strong>"}function j(z,A){if(z=="District"){document.getElementById("district").value=A}if(z=="Single Lower Tier"){document.getElementById("lower").value=A}if(z=="Upper Tier"){document.getElementById("upper").value=A}}function l(C,E){var B="";var F=1;if(C=="District"){B="#8583f3";F=2}if(C=="Single Lower Tier"){B="#0083f3";F=4}if(C=="Upper Tier"){B="#858300";F=4}var z=E.getPaths().getLength();for(var D=0;D<z;D++){var A=new google.maps.Polyline({path:E.getPaths().getAt(D),strokeColor:B,strokeOpacity:1,strokeWeight:F});A.setMap(e);x.push(A)}}function h(K,H,F,E){var G=K.results;var L=[];var J=[];var I=[];for(var D=0;D<G.length;D++){var M=G[D];switch(M.layerId){case 0:L.push(M);break;case 1:J.push(M);break;case 2:I.push(M);break}}var C=u("District",H,L);var B=u("Single Lower Tier",H,J);var A=u("Upper Tier",H,I);F=F+"<br>"+C+"<br>"+B+"<br>"+A;m=new google.maps.Marker({position:H,map:e});(function(N,O){google.maps.event.addListener(O,"click",function(){t.setContent('<div style="width:300px;height:100px;overflow:auto;font-size:small">'+N.trim()+"</div>");t.setPosition(O.getPosition());t.open(e)})})(F,m);var z=e.getBounds();w(z,H);if(!mapConfig.withinExtent){e.setCenter(H);e.setZoom(E);v()}}function d(z,A,B){g(z,B,A)}function w(A,z){if(mapConfig.withinExtent){if((typeof x!="undefined")&&(MOEMAP_TOOLS.isPolylineListWithinBounds(x,A))){MESSAGE.locatorSucceed();return}if(!A.contains(z)){MESSAGE.locatorFailed()}else{MESSAGE.locatorSucceed()}}else{MESSAGE.locatorSucceed()}}function s(z){r();LOCATOR.locate(z)}function b(z){n(z,false)}function n(z,B){r();var A=new gmaps.ags.Layer(mapConfig.url+"/"+mapConfig.layerIds[0]);var C={returnGeometry:true,where:z,outFields:mapConfig.outFields};if(mapConfig.withinExtent){C.geometry=e.getBounds()}A.query(C,function(G){if((typeof G.features!=="undefined")&&(G.features.length>0)){var N=G.features.length;var D=new google.maps.LatLngBounds();for(var M=0;M<N;M++){var E=G.features[M];var F=E.geometry[0].getPosition();if(!mapConfig.withinExtent){D.extend(F)}var J=E.attributes;var H=TABS_CALCULATOR.getContent(J,mapConfig.tabs);var L=(H[0]).content;if(H.length>1){L=mapConfig.multipleTabsPopup(H)}var K=new google.maps.Marker({position:F,map:e});(function(P,O){google.maps.event.addListener(O,"click",function(){t.setContent(P);t.setPosition(O.getPosition());t.open(e)})})(L,K);k.push(K)}if(!mapConfig.withinExtent){e.fitBounds(D);var I=e.getZoom();if(I>MOEMapGlobalConfig.predefinedLevel){e.setZoom(MOEMapGlobalConfig.predefinedLevel)}v()}MESSAGE.messageSearch(N)}else{if(B){LOCATOR.locate(mapConfig.address)}else{MESSAGE.messageSearch(0)}}})}function r(){if(m!==null){m.setMap(null)}m=null;if(t){t.close()}for(var z=0;z<x.length;z++){(x[z]).setMap(null)}x=[];for(var z=0;z<k.length;z++){(k[z]).setMap(null)}k=[]}function f(C){var z=C.getPaths().getLength();for(var B=0;B<z;B++){var A=new google.maps.Polyline({path:C.getPaths().getAt(B),strokeColor:"#8583f3",strokeOpacity:1,strokeWeight:4});A.setMap(e);x.push(A)}}var a={init:o,entsub:q,locateMap:d,addPolyline:f,queryLayerWithLocator:s,queryLayerWithoutLocator:b};return a})();