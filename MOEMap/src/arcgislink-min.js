/*
acgislink.js is modified to decrease the number of digitals after the decimal point. Now the 
latitude and longitude only have six digitals after the decimal point. The length of URL is decreased 
to make sure when buffer circle is combined with other conditions, the application is still working. 
*/
(function(){function extractString_(e,t,n){var r=t===""?0:e.indexOf(t);var i=n===""?e.length:e.indexOf(n,r+t.length);return e.substring(r+t.length,i)}function isString_(e){return e&&typeof e==="string"}function isArray_(e){return e&&e.splice}function isNumber_(e){return typeof e==="number"}function augmentObject_(e,t,n){if(e&&t){var r;for(r in e){if(n||!(r in t)){t[r]=e[r]}}}return t}function triggerEvent_(e,t,n){G.event.trigger.apply(this,arguments)}function handleErr_(e,t){if(e&&t&&t.error){e(t.error)}}function formatTimeString_(e,t){var n="";if(e){n+=e.getTime()-e.getTimezoneOffset()*6e4}if(t){n+=", "+(t.getTime()-t.getTimezoneOffset()*6e4)}return n}function setNodeOpacity_(e,t){t=Math.min(Math.max(t,0),1);if(e){var n=e.style;if(typeof n.opacity!=="undefined"){n.opacity=t}if(typeof n.filters!=="undefined"){n.filters.alpha.opacity=Math.floor(100*t)}if(typeof n.filter!=="undefined"){n.filter="alpha(opacity:"+Math.floor(t*100)+")"}}}function getLayerDefsString_(e){var t="";for(var n in e){if(e.hasOwnProperty(n)){if(t.length>0){t+=";"}t+=n+":"+e[n]}}return t}function getXmlHttp_(){if(typeof XMLHttpRequest==="undefined"){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(t){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(n){}throw new Error("This browser does not support XMLHttpRequest.")}else{return new XMLHttpRequest}}function getGeometryType_(e){var t=e;if(isArray_(e)&&e.length>0){t=e[0]}if(t instanceof G.LatLng||t instanceof G.Marker){if(isArray_(e)&&e.length>1){return GeometryType.MULTIPOINT}else{return GeometryType.POINT}}else if(t instanceof G.Polyline){return GeometryType.POLYLINE}else if(t instanceof G.Polygon){return GeometryType.POLYGON}else if(t instanceof G.LatLngBounds){return GeometryType.ENVELOPE}else if(t.x!==undefined&&t.y!==undefined){return GeometryType.POINT}else if(t.points){return GeometryType.MULTIPOINT}else if(t.paths){return GeometryType.POLYLINE}else if(t.rings){return GeometryType.POLYGON}return null}function isOverlay_(e){var t=e;if(isArray_(e)&&e.length>0){t=e[0]}if(isArray_(t)&&t.length>0){t=t[0]}if(t instanceof G.LatLng||t instanceof G.Marker||t instanceof G.Polyline||t instanceof G.Polygon||t instanceof G.LatLngBounds){return true}return false}function formatSRParam_(e){if(!e){return null}return isNumber_(e)?e:e.wkid?e.wkid:e.toJSON()}function fromLatLngsToJSON_(e,t){var n=[];var r;for(var i=0,s=e.getLength();i<s;i++){r=e.getAt(i);n.push("["+r.lng().toFixed(6)+","+r.lat().toFixed(6)+"]")}if(t&&n.length>0){n.push("["+e.getAt(0).lng().toFixed(6)+","+e.getAt(0).lat().toFixed(6)+"]")}return n.join(",")}function fromOverlaysToJSON_(e){var t=getGeometryType_(e);var n,r,i,s;var o="{";switch(t){case GeometryType.POINT:n=isArray_(e)?e[0]:e;if(n instanceof G.Marker){n=n.getPosition()}o+="x:"+n.lng()+",y:"+n.lat();break;case GeometryType.MULTIPOINT:s=[];for(i=0;i<e.length;i++){if(e[i]instanceof G.Marker){n=e[i].getPosition()}else{n=e[i]}s.push("["+n.lng()+","+n.lat()+"]")}o+="points: ["+s.join(",")+"]";break;case GeometryType.POLYLINE:s=[];r=isArray_(e)?e:[e];for(i=0;i<r.length;i++){s.push("["+fromLatLngsToJSON_(r[i].getPath())+"]")}o+="paths:["+s.join(",")+"]";break;case GeometryType.POLYGON:s=[];n=isArray_(e)?e[0]:e;var u=n.getPaths();for(i=0;i<u.getLength();i++){s.push("["+fromLatLngsToJSON_(u.getAt(i),true)+"]")}o+="rings:["+s.join(",")+"]";break;case GeometryType.ENVELOPE:n=isArray_(e)?e[0]:e;o+="xmin:"+n.getSouthWest().lng()+",ymin:"+n.getSouthWest().lat()+",xmax:"+n.getNorthEast().lng()+",ymax:"+n.getNorthEast().lat();break}o+=", spatialReference:{wkid:4326}";o+="}";return o}function fromGeometryToJSON_(e){function t(e){var t=[];for(var n=0,r=e.length;n<r;n++){t.push("["+e[n][0]+","+e[n][1]+"]")}return"["+t.join(",")+"]"}function n(e){var n=[];for(var r=0,i=e.length;r<i;r++){n.push(t(e[r]))}return"["+n.join(",")+"]"}var r="{";if(e.x){r+="x:"+e.x+",y:"+e.y}else if(e.xmin){r+="xmin:"+e.xmin+",ymin:"+e.ymin+",xmax:"+e.xmax+",ymax:"+e.ymax}else if(e.points){r+="points:"+t(e.points)}else if(e.paths){r+="paths:"+n(e.paths)}else if(e.rings){r+="rings:"+n(e.rings)}r+="}";return r}function fromEnvelopeToLatLngBounds_(e){var t=spatialReferences_[e.spatialReference.wkid||e.spatialReference.wkt];t=t||WGS84;var n=t.inverse([e.xmin,e.ymin]);var r=t.inverse([e.xmax,e.ymax]);return new G.LatLngBounds(new G.LatLng(n[1],n[0]),new G.LatLng(r[1],r[0]))}function fromJSONToOverlays_(e,t){var n=null;var r;var i,s,o,u,a,f,l,c;t=t||{};if(e){n=[];if(e.x){r=new G.Marker(augmentObject_(t.markerOptions||t,{position:new G.LatLng(e.y,e.x)}));n.push(r)}else{a=e.points||e.paths||e.rings;if(!a){return n}var h=[];for(i=0,s=a.length;i<s;i++){f=a[i];if(e.points){r=new G.Marker(augmentObject_(t.markerOptions||t,{position:new G.LatLng(f[1],f[0])}));n.push(r)}else{c=[];for(o=0,u=f.length;o<u;o++){l=f[o];c.push(new G.LatLng(l[1],l[0]))}if(e.paths){r=new G.Polyline(augmentObject_(t.polylineOptions||t,{path:c}));n.push(r)}else if(e.rings){h.push(c)}}}if(e.rings){r=new G.Polygon(augmentObject_(t.polygonOptions||t,{paths:h}));n.push(r)}}}return n}function parseFeatures_(e,t){if(e){var n,r,i;for(n=0,r=e.length;n<r;n++){i=e[n];if(i.geometry){i.geometry=fromJSONToOverlays_(i.geometry,t)}}}}function formatRequestString_(e){var t;if(typeof e==="object"){if(isArray_(e)){t=[];for(var n=0,r=e.length;n<r;n++){t.push(formatRequestString_(e[n]))}return"["+t.join(",")+"]"}else if(isOverlay_(e)){return fromOverlaysToJSON_(e)}else if(e.toJSON){return e.toJSON()}else{t="";for(var i in e){if(e.hasOwnProperty(i)){if(t.length>0){t+=", "}t+=i+":"+formatRequestString_(e[i])}}return"{"+t+"}"}}return e.toString()}function fromLatLngsToFeatureSet_(e){var t,n,r;var i=[];for(t=0,n=e.length;t<n;t++){r=e[t];if(r instanceof G.Marker){r=r.getPosition()}i.push({geometry:{x:r.lng(),y:r.lat(),spatialReference:{wkid:4326}}})}return{type:'"features"',features:i,doNotLocateOnRestrictedElements:false}}function prepareGeometryParams_(e){var t={};if(!e){return null}var n=[];var r,i;if(e.geometries&&e.geometries.length>0){r=e.geometries[0];i=isOverlay_(r);for(var s=0,o=e.geometries.length;s<o;s++){if(i){n.push(fromOverlaysToJSON_(e.geometries[s]))}else{n.push(fromGeometryToJSON_(e.geometries[s]))}}}if(!e.geometryType){e.geometryType=getGeometryType_(r)}if(i){t.inSR=WGS84.wkid}else if(e.inSpatialReference){t.inSR=formatSRParam_(e.inSpatialReference)}if(e.outSpatialReference){t.outSR=formatSRParam_(e.outSpatialReference)}t.geometries='{geometryType:"'+e.geometryType+'", geometries:['+n.join(",")+"]}";return t}function log_(e){if(window.console){window.console.log(e)}else{var t=document.getElementById("_ags_log");if(t){t.innerHTML=t.innerHTML+e+"<br/>"}}}function formatParams_(e){var t="";if(e){e.f=e.f||"json";for(var n in e){if(e.hasOwnProperty(n)&&e[n]!==null&&e[n]!==undefined){var r=formatRequestString_(e[n]);t+=(t.length>0?"&":"")+(n+"="+(escape?escape(r):encodeURIComponent(r)))}}}return t}function callback_(e,t){var n=[];for(var r=2,i=arguments.length;r<i;r++){n.push(arguments[r])}return function(){e.apply(t,n)}}function addCopyrightInfo_(e,t,n){if(t.hasLoaded()){e.push(t.copyrightText)}else{G.event.addListenerOnce(t,"load",function(){setCopyrightInfo_(n)})}}function setCopyrightInfo_(e){var t=null;if(e){var n=e.controls[G.ControlPosition.BOTTOM_RIGHT];if(n){for(var r=0,i=n.getLength();r<i;r++){if(n.getAt(r).id==="agsCopyrights"){t=n.getAt(r);break}}}if(!t){t=document.createElement("div");t.style.fontFamily="Arial,sans-serif";t.style.fontSize="10px";t.style.textAlign="right";t.id="agsCopyrights";e.controls[G.ControlPosition.BOTTOM_RIGHT].push(t);G.event.addListener(e,"maptypeid_changed",function(){setCopyrightInfo_(e)})}var s=e.agsOverlays;var o=[];var u,a;if(s){for(var r=0,i=s.getLength();r<i;r++){addCopyrightInfo_(o,s.getAt(r).mapService_,e)}}var f=e.overlayMapTypes;if(f){for(var r=0,i=f.getLength();r<i;r++){a=f.getAt(r);if(a instanceof MapType){for(var l=0,c=a.tileLayers_.length;l<c;l++){addCopyrightInfo_(o,a.tileLayers_[l].mapService_,e)}}}}a=e.mapTypes.get(e.getMapTypeId());if(a instanceof MapType){for(var r=0,i=a.tileLayers_.length;r<i;r++){addCopyrightInfo_(o,a.tileLayers_[r].mapService_,e)}if(a.negative){t.style.color="#ffffff"}else{t.style.color="#000000"}}t.innerHTML=o.join("<br/>")}}function getJSON_(url,params,callbackName,callbackFn){var sid="ags_jsonp_"+jsonpID_++ +"_"+Math.floor(Math.random()*1e6);var script=null;params=params||{};params[callbackName||"callback"]="ags_jsonp."+sid;var query=formatParams_(params);var head=document.getElementsByTagName("head")[0];if(!head){throw new Error("document must have header tag")}var jsonpcallback=function(){if(window["ags_jsonp"][sid]){delete window["ags_jsonp"][sid]}if(script){head.removeChild(script)}script=null;callbackFn.apply(null,arguments);triggerEvent_(Util,"jsonpend",sid)};window["ags_jsonp"][sid]=jsonpcallback;if((query+url).length<2e3&&!Config.alwaysUseProxy){script=document.createElement("script");script.src=url+(url.indexOf("?")===-1?"?":"&")+query;script.id=sid;head.appendChild(script)}else{var loc=window.location;var dom=loc.protocol+"//"+loc.hostname+(!loc.port||loc.port===80?"":":"+loc.port+"/");var useProxy=true;if(url.toLowerCase().indexOf(dom.toLowerCase())!==-1){useProxy=false}if(Config.alwaysUseProxy){useProxy=true}if(useProxy&&!Config.proxyUrl){throw new Error("No proxyUrl property in Config is defined")}var xmlhttp=getXmlHttp_();xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState===4){if(xmlhttp.status===200){eval(xmlhttp.responseText)}else{throw new Error("Error code "+xmlhttp.status)}}};xmlhttp.open("POST",useProxy?Config.proxyUrl+"?"+url:url,true);xmlhttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlhttp.send(query)}triggerEvent_(Util,"jsonpstart",sid);return sid}function SpatialReference(e){e=e||{};this.wkid=e.wkid;this.wkt=e.wkt}function Geographic(e){e=e||{};SpatialReference.call(this,e)}function LambertConformalConic(e){e=e||{};SpatialReference.call(this,e);var t=e.inverse_flattening;var n=e.standard_parallel_1*RAD_DEG;var r=e.standard_parallel_2*RAD_DEG;var i=e.latitude_of_origin*RAD_DEG;this.a_=e.semi_major/e.unit;this.lamda0_=e.central_meridian*RAD_DEG;this.FE_=e.false_easting;this.FN_=e.false_northing;var s=1/t;var o=2*s-s*s;this.e_=Math.sqrt(o);var u=this.calc_m_(n,o);var a=this.calc_m_(r,o);var f=this.calc_t_(i,this.e_);var l=this.calc_t_(n,this.e_);var c=this.calc_t_(r,this.e_);this.n_=Math.log(u/a)/Math.log(l/c);this.F_=u/(this.n_*Math.pow(l,this.n_));this.rho0_=this.calc_rho_(this.a_,this.F_,f,this.n_)}function TransverseMercator(e){e=e||{};SpatialReference.call(this,e);this.a_=e.semi_major/e.unit;var t=e.inverse_flattening;this.k0_=e.scale_factor;var n=e.latitude_of_origin*RAD_DEG;this.lamda0_=e.central_meridian*RAD_DEG;this.FE_=e.false_easting;this.FN_=e.false_northing;var r=1/t;this.es_=2*r-r*r;this.ep4_=this.es_*this.es_;this.ep6_=this.ep4_*this.es_;this.eas_=this.es_/(1-this.es_);this.M0_=this.calc_m_(n,this.a_,this.es_,this.ep4_,this.ep6_)}function SphereMercator(e){e=e||{};SpatialReference.call(this,e);this.a_=(e.semi_major||6378137)/(e.unit||1);this.lamda0_=(e.central_meridian||0)*RAD_DEG}function Albers(e){e=e||{};SpatialReference.call(this,e);var t=e.inverse_flattening;var n=e.standard_parallel_1*RAD_DEG;var r=e.standard_parallel_2*RAD_DEG;var i=e.latitude_of_origin*RAD_DEG;this.a_=e.semi_major/e.unit;this.lamda0_=e.central_meridian*RAD_DEG;this.FE_=e.false_easting;this.FN_=e.false_northing;var s=1/t;var o=2*s-s*s;this.e_=Math.sqrt(o);var u=this.calc_m_(n,o);var a=this.calc_m_(r,o);var f=this.calc_q_(n,this.e_);var l=this.calc_q_(r,this.e_);var c=this.calc_q_(i,this.e_);this.n_=(u*u-a*a)/(l-f);this.C_=u*u+this.n_*f;this.rho0_=this.calc_rho_(this.a_,this.C_,this.n_,c)}function Catalog(e){this.url=e;var t=this;getJSON_(e,{},"",function(e){augmentObject_(e,t);triggerEvent_(t,"load")})}function Layer(e){this.url=e;this.definition=null}function MapService(e,t){this.url=e;this.loaded_=false;var n=e.split("/");this.name=n[n.length-2].replace(/_/g," ");t=t||{};if(t.delayLoad){var r=this;window.setTimeout(function(){r.loadServiceInfo()},t.delayLoad*1e3)}else{this.loadServiceInfo()}}function GeocodeService(e){this.url=e;this.loaded_=false;var t=this;getJSON_(e,{},"",function(e){t.init_(e)})}function GeometryService(e){this.url=e;this.t="geocodeservice"}function GPService(e){this.url=e;this.loaded_=false;var t=this;getJSON_(e,{},"",function(e){augmentObject_(e,t);t.loaded_=true;triggerEvent_(t,"load")})}function GPTask(e){this.url=e;this.loaded_=false;var t=this;getJSON_(e,{},"",function(e){augmentObject_(e,t);t.loaded_=true;triggerEvent_(t,"load")})}function NetworkService(e){this.url=e;this.loaded_=false;var t=this;getJSON_(e,{},"",function(e){augmentObject_(e,t);t.loaded_=true;triggerEvent_(t,"load")})}function RouteTask(e){this.url=e}function Projection(e){this.lods_=e?e.lods:null;this.spatialReference_=e?spatialReferences_[e.spatialReference.wkid||e.spatialReference.wkt]:WEB_MERCATOR;if(!this.spatialReference_){throw new Error("unsupported Spatial Reference")}this.resolution0_=e?e.lods[0].resolution:156543.033928;this.minZoom=Math.floor(Math.log(this.spatialReference_.getCircum()/this.resolution0_/256)/Math.LN2+.5);this.maxZoom=e?this.minZoom+this.lods_.length-1:20;if(G.Size){this.tileSize_=e?new G.Size(e.cols,e.rows):new G.Size(256,256)}this.scale_=Math.pow(2,this.minZoom)*this.resolution0_;this.originX_=e?e.origin.x:-20037508.342787;this.originY_=e?e.origin.y:20037508.342787;if(e){var t;for(var n=0;n<e.lods.length-1;n++){t=e.lods[n].resolution/e.lods[n+1].resolution;if(t>2.001||t<1.999){throw new Error("This type of map cache is not supported in V3. \nScale ratio between zoom levels must be 2")}}}}function TileLayer(e,t){t=t||{};if(t.opacity){this.opacity_=t.opacity;delete t.opacity}augmentObject_(t,this);this.mapService_=e instanceof MapService?e:new MapService(e);if(t.hosts){var n=extractString_(this.mapService_.url,"","://");var r=extractString_(this.mapService_.url,"://","/");var i=extractString_(this.mapService_.url,n+"://"+r,"");this.urlTemplate_=n+"://"+t.hosts+i;this.numOfHosts_=parseInt(extractString_(t.hosts,"[","]"),10)}this.name=t.name||this.mapService_.name;this.maxZoom=t.maxZoom||19;this.minZoom=t.minZoom||0;this.dynaZoom=t.dynaZoom||this.maxZoom;if(this.mapService_.loaded_){this.init_(t)}else{var s=this;G.event.addListenerOnce(this.mapService_,"load",function(){s.init_(t)})}this.tiles_={};this.map_=t.map}function MapType(e,t){t=t||{};var n;if(t.opacity){this.opacity_=t.opacity;delete t.opacity}augmentObject_(t,this);var r=e;if(isString_(e)){r=[new TileLayer(e,t)]}else if(e instanceof MapService){r=[new TileLayer(e,t)]}else if(e instanceof TileLayer){r=[e]}else if(e.length>0&&isString_(e[0])){r=[];for(n=0;n<e.length;n++){r[n]=new TileLayer(e[n],t)}}this.tileLayers_=r;this.tiles_={};if(t.maxZoom!==undefined){this.maxZoom=t.maxZoom}else{var i=0;for(n=0;n<r.length;n++){i=Math.max(i,r[n].maxZoom)}this.maxZoom=i}if(r[0].projection_){this.tileSize=r[0].projection_.tileSize_;this.projection=r[0].projection_}else{this.tileSize=new G.Size(256,256)}if(!this.name){this.name=r[0].name}}function MapOverlay(e,t){t=t||{};this.mapService_=e instanceof MapService?e:new MapService(e);this.minZoom=t.minZoom;this.maxZoom=t.maxZoom;this.opacity_=t.opacity||1;this.exportOptions_=t.exportOptions||{};this.drawing_=false;this.needsNewRefresh_=false;this.overlay_=null;this.div_=null;if(t.map){this.setMap(t.map)}this.map_=null;this.listeners_=[]}function ImageOverlay(e,t,n,r){this.bounds_=e;this.url_=t;this.map_=n;this.div_=null;this.op_=r;this.setMap(n)}function CopyrightControl(e){this.map_=e;setCopyrightInfo_(e)}var gmaps=gmaps||{};var RAD_DEG=Math.PI/180;var jsonpID_=0;window["ags_jsonp"]=window["ags_jsonp"]||{};var G=google.maps;var WGS84,NAD83,WEB_MERCATOR,WEB_MERCATOR_AUX;var Config={proxyUrl:null,alwaysUseProxy:false};var spatialReferences_={};var Util={};var GeometryType={POINT:"esriGeometryPoint",MULTIPOINT:"esriGeometryMultipoint",POLYLINE:"esriGeometryPolyline",POLYGON:"esriGeometryPolygon",ENVELOPE:"esriGeometryEnvelope"};Util.getJSON=function(e,t,n,r){getJSON_(e,t,n,r)};Util.addToMap=function(e,t){if(isArray_(t)){var n;for(var r=0,i=t.length;r<i;r++){n=t[r];if(isArray_(n)){Util.addToMap(e,n)}else if(isOverlay_(n)){n.setMap(e)}}}};Util.removeFromMap=function(e,t){Util.addToMap(null,e);if(t){e.length=0}};SpatialReference.prototype.forward=function(e){return e};SpatialReference.prototype.inverse=function(e){return e};SpatialReference.prototype.getCircum=function(){return 360};SpatialReference.prototype.toJSON=function(){return"{"+(this.wkid?" wkid:"+this.wkid:"wkt: '"+this.wkt+"'")+"}"};Geographic.prototype=new SpatialReference;LambertConformalConic.prototype=new SpatialReference;LambertConformalConic.prototype.calc_m_=function(e,t){var n=Math.sin(e);return Math.cos(e)/Math.sqrt(1-t*n*n)};LambertConformalConic.prototype.calc_t_=function(e,t){var n=t*Math.sin(e);return Math.tan(Math.PI/4-e/2)/Math.pow((1-n)/(1+n),t/2)};LambertConformalConic.prototype.calc_rho_=function(e,t,n,r){return e*t*Math.pow(n,r)};LambertConformalConic.prototype.calc_phi_=function(e,t,n){var r=t*Math.sin(n);return Math.PI/2-2*Math.atan(e*Math.pow((1-r)/(1+r),t/2))};LambertConformalConic.prototype.solve_phi_=function(e,t,n){var r=0;var i=n;var s=this.calc_phi_(e,t,i);while(Math.abs(s-i)>1e-9&&r<10){r++;i=s;s=this.calc_phi_(e,t,i)}return s};LambertConformalConic.prototype.forward=function(e){var t=e[1]*RAD_DEG;var n=e[0]*RAD_DEG;var r=this.calc_t_(t,this.e_);var i=this.calc_rho_(this.a_,this.F_,r,this.n_);var s=this.n_*(n-this.lamda0_);var o=this.FE_+i*Math.sin(s);var u=this.FN_+this.rho0_-i*Math.cos(s);return[o,u]};LambertConformalConic.prototype.inverse=function(e){var t=e[0]-this.FE_;var n=e[1]-this.FN_;var r=Math.atan(t/(this.rho0_-n));var i=(this.n_>0?1:-1)*Math.sqrt(t*t+(this.rho0_-n)*(this.rho0_-n));var s=Math.pow(i/(this.a_*this.F_),1/this.n_);var o=Math.PI/2-2*Math.atan(s);var u=this.solve_phi_(s,this.e_,o);var a=r/this.n_+this.lamda0_;return[a/RAD_DEG,u/RAD_DEG]};LambertConformalConic.prototype.getCircum=function(){return Math.PI*2*this.a_};TransverseMercator.prototype=new SpatialReference;TransverseMercator.prototype.calc_m_=function(e,t,n,r,i){return t*((1-n/4-3*r/64-5*i/256)*e-(3*n/8+3*r/32+45*i/1024)*Math.sin(2*e)+(15*r/256+45*i/1024)*Math.sin(4*e)-35*i/3072*Math.sin(6*e))};TransverseMercator.prototype.forward=function(e){var t=e[1]*RAD_DEG;var n=e[0]*RAD_DEG;var r=this.a_/Math.sqrt(1-this.es_*Math.pow(Math.sin(t),2));var i=Math.pow(Math.tan(t),2);var s=this.eas_*Math.pow(Math.cos(t),2);var o=(n-this.lamda0_)*Math.cos(t);var u=this.calc_m_(t,this.a_,this.es_,this.ep4_,this.ep6_);var a=this.FE_+this.k0_*r*(o+(1-i+s)*Math.pow(o,3)/6+(5-18*i+i*i+72*s-58*this.eas_)*Math.pow(o,5)/120);var f=this.FN_+this.k0_*(u-this.M0_)+r*Math.tan(t)*(o*o/2+(5-i+9*s+4*s*s)*Math.pow(o,4)/120+(61-58*i+i*i+600*s-330*this.eas_)*Math.pow(o,6)/720);return[a,f]};TransverseMercator.prototype.inverse=function(e){var t=e[0];var n=e[1];var r=(1-Math.sqrt(1-this.es_))/(1+Math.sqrt(1-this.es_));var i=this.M0_+(n-this.FN_)/this.k0_;var s=i/(this.a_*(1-this.es_/4-3*this.ep4_/64-5*this.ep6_/256));var o=s+(3*r/2-27*Math.pow(r,3)/32)*Math.sin(2*s)+(21*r*r/16-55*Math.pow(r,4)/32)*Math.sin(4*s)+151*Math.pow(r,3)/6*Math.sin(6*s)+1097*Math.pow(r,4)/512*Math.sin(8*s);var u=this.eas_*Math.pow(Math.cos(o),2);var a=Math.pow(Math.tan(o),2);var f=this.a_/Math.sqrt(1-this.es_*Math.pow(Math.sin(o),2));var l=this.a_*(1-this.es_)/Math.pow(1-this.es_*Math.pow(Math.sin(o),2),3/2);var c=(t-this.FE_)/(f*this.k0_);var h=o-f*Math.tan(o)/l*(c*c/2-(5+3*a+10*u-4*u*u-9*this.eas_)*Math.pow(c,4)/24+(61+90*a+28*u+45*a*a-252*this.eas_-3*u*u)*Math.pow(c,6)/720);var p=this.lamda0_+(c-(1+2*a+u)*Math.pow(c,3)/6+(5-2*u+28*a-3*u*u+8*this.eas_+24*a*a)*Math.pow(c,5)/120)/Math.cos(o);return[p/RAD_DEG,h/RAD_DEG]};TransverseMercator.prototype.getCircum=function(){return Math.PI*2*this.a_};SphereMercator.prototype=new SpatialReference;SphereMercator.prototype.forward=function(e){var t=e[1]*RAD_DEG;var n=e[0]*RAD_DEG;var r=this.a_*(n-this.lamda0_);var i=this.a_/2*Math.log((1+Math.sin(t))/(1-Math.sin(t)));return[r,i]};SphereMercator.prototype.inverse=function(e){var t=e[0];var n=e[1];var r=Math.PI/2-2*Math.atan(Math.exp(-n/this.a_));var i=t/this.a_+this.lamda0_;return[i/RAD_DEG,r/RAD_DEG]};SphereMercator.prototype.getCircum=function(){return Math.PI*2*this.a_};Albers.prototype=new SpatialReference;Albers.prototype.calc_m_=function(e,t){var n=Math.sin(e);return Math.cos(e)/Math.sqrt(1-t*n*n)};Albers.prototype.calc_q_=function(e,t){var n=t*Math.sin(e);return(1-t*t)*(Math.sin(e)/(1-n*n)-1/(2*t)*Math.log((1-n)/(1+n)))};Albers.prototype.calc_rho_=function(e,t,n,r){return e*Math.sqrt(t-n*r)/n};Albers.prototype.calc_phi_=function(e,t,n){var r=t*Math.sin(n);return n+(1-r*r)*(1-r*r)/(2*Math.cos(n))*(e/(1-t*t)-Math.sin(n)/(1-r*r)+Math.log((1-r)/(1+r))/(2*t))};Albers.prototype.solve_phi_=function(e,t,n){var r=0;var i=n;var s=this.calc_phi_(e,t,i);while(Math.abs(s-i)>1e-8&&r<10){r++;i=s;s=this.calc_phi_(e,t,i)}return s};Albers.prototype.forward=function(e){var t=e[1]*RAD_DEG;var n=e[0]*RAD_DEG;var r=this.calc_q_(t,this.e_);var i=this.calc_rho_(this.a_,this.C_,this.n_,r);var s=this.n_*(n-this.lamda0_);var o=this.FE_+i*Math.sin(s);var u=this.FN_+this.rho0_-i*Math.cos(s);return[o,u]};Albers.prototype.inverse=function(e){var t=e[0]-this.FE_;var n=e[1]-this.FN_;var r=Math.sqrt(t*t+(this.rho0_-n)*(this.rho0_-n));var i=this.n_>0?1:-1;var s=Math.atan(i*t/(i*this.rho0_-i*n));var o=(this.C_-r*r*this.n_*this.n_/(this.a_*this.a_))/this.n_;var u=Math.asin(o/2);var a=this.solve_phi_(o,this.e_,u);var f=s/this.n_+this.lamda0_;return[f/RAD_DEG,a/RAD_DEG]};Albers.prototype.getCircum=function(){return Math.PI*2*this.a_};Albers.prototype.getCircum=function(){return Math.PI*2*this.a_};WGS84=new Geographic({wkid:4326});NAD83=new Geographic({wkid:4269});WEB_MERCATOR=new SphereMercator({wkid:102113,semi_major:6378137,central_meridian:0,unit:1});WEB_MERCATOR_AUX=new SphereMercator({wkid:102100,semi_major:6378137,central_meridian:0,unit:1});spatialReferences_={4326:WGS84,4269:NAD83,102113:WEB_MERCATOR,102100:WEB_MERCATOR_AUX};SpatialReference.WGS84=WGS84;SpatialReference.NAD83=NAD83;SpatialReference.WEB_MERCATOR=WEB_MERCATOR;SpatialReference.WEB_MERCATOR_AUX=WEB_MERCATOR_AUX;Util.registerSR=function(e,t){var n=spatialReferences_[""+e];if(n){return n}if(t instanceof SpatialReference){spatialReferences_[""+e]=t;n=t}else{var r=t||e;var i={wkt:e};if(e===parseInt(e,10)){i={wkid:e}}var s=extractString_(r,'PROJECTION["','"]');var o=extractString_(r,"SPHEROID[","]").split(",");if(s!==""){i.unit=parseFloat(extractString_(extractString_(r,"PROJECTION",""),"UNIT[","]").split(",")[1]);i.semi_major=parseFloat(o[1]);i.inverse_flattening=parseFloat(o[2]);i.latitude_of_origin=parseFloat(extractString_(r,'"Latitude_Of_Origin",',"]"));i.central_meridian=parseFloat(extractString_(r,'"Central_Meridian",',"]"));i.false_easting=parseFloat(extractString_(r,'"False_Easting",',"]"));i.false_northing=parseFloat(extractString_(r,'"False_Northing",',"]"))}switch(s){case"":n=new SpatialReference(i);break;case"Lambert_Conformal_Conic":i.standard_parallel_1=parseFloat(extractString_(r,'"Standard_Parallel_1",',"]"));i.standard_parallel_2=parseFloat(extractString_(r,'"Standard_Parallel_2",',"]"));n=new LambertConformalConic(i);break;case"Transverse_Mercator":i.scale_factor=parseFloat(extractString_(r,'"Scale_Factor",',"]"));n=new TransverseMercator(i);break;case"Albers":i.standard_parallel_1=parseFloat(extractString_(r,'"Standard_Parallel_1",',"]"));i.standard_parallel_2=parseFloat(extractString_(r,'"Standard_Parallel_2",',"]"));n=new Albers(i);break;default:throw new Error(s+"  not supported")}if(n){spatialReferences_[""+e]=n}}return n};Layer.prototype.load=function(){var e=this;if(this.loaded_){return}getJSON_(this.url,{},"",function(t){augmentObject_(t,e);e.loaded_=true;triggerEvent_(e,"load")})};Layer.prototype.isInScale=function(e){if(this.maxScale&&this.maxScale>e){return false}if(this.minScale&&this.minScale<e){return false}return true};var SpatialRelationship={INTERSECTS:"esriSpatialRelIntersects",CONTAINS:"esriSpatialRelContains",CROSSES:"esriSpatialRelCrosses",ENVELOPE_INTERSECTS:"esriSpatialRelEnvelopeIntersects",INDEX_INTERSECTS:"esriSpatialRelIndexIntersects",OVERLAPS:"esriSpatialRelOverlaps",TOUCHES:"esriSpatialRelTouches",WITHIN:"esriSpatialRelWithin"};Layer.prototype.query=function(e,t,n){if(!e){return}var r=augmentObject_(e,{});if(e.geometry&&!isString_(e.geometry)){r.geometry=fromOverlaysToJSON_(e.geometry);r.geometryType=getGeometryType_(e.geometry);r.inSR=4326}if(e.spatialRelationship){r.spatialRel=e.spatialRelationship;delete r.spatialRelationship}if(e.outFields&&isArray_(e.outFields)){r.outFields=e.outFields.join(",")}if(e.objectIds){r.objectIds=e.objectIds.join(",")}if(e.time){r.time=formatTimeString_(e.time,e.endTime)}r.outSR=4326;r.returnGeometry=e.returnGeometry===false?false:true;r.returnIdsOnly=e.returnIdsOnly===true?true:false;delete r.overlayOptions;getJSON_(this.url+"/query",r,"",function(r){parseFeatures_(r.features,e.overlayOptions);t(r,r.error);handleErr_(n,r)})};Layer.prototype.queryRelatedRecords=function(e,t,n){if(!e){return}var r=augmentObject_(e,{});r.f=r.f||"json";if(r.outFields&&!isString_(r.outFields)){r.outFields=r.outFields.join(",")}r.returnGeometry=r.returnGeometry===false?false:true;getJSON_(this.url+"/query",r,"",function(e){handleErr_(n,e);t(e)})};MapService.prototype.loadServiceInfo=function(){var e=this;getJSON_(this.url,{},"",function(t){e.init_(t)})};MapService.prototype.init_=function(e){var t=this;if(e.error){throw new Error(e.error.message)}augmentObject_(e,this);if(e.spatialReference.wkt){this.spatialReference=Util.registerSR(e.spatialReference.wkt)}else{this.spatialReference=spatialReferences_[e.spatialReference.wkid]}if(e.tables!==undefined){getJSON_(this.url+"/layers",{},"",function(e){t.initLayers_(e);getJSON_(t.url+"/legend",{},"",function(e){t.initLegend_(e);t.setLoaded_()})})}else{t.initLayers_(e);t.setLoaded_()}};MapService.prototype.setLoaded_=function(){this.loaded_=true;triggerEvent_(this,"load")};MapService.prototype.initLayers_=function(e){var t=[];var n=[];this.layers=t;if(e.tables){this.tables=n}var r,i,s,o;for(i=0,s=e.layers.length;i<s;i++){o=e.layers[i];r=new Layer(this.url+"/"+o.id);augmentObject_(o,r);r.visible=r.defaultVisibility;t.push(r)}if(e.tables){for(i=0,s=e.tables.length;i<s;i++){o=e.tables[i];r=new Layer(this.url+"/"+o.id);augmentObject_(o,r);n.push(r)}}for(i=0,s=t.length;i<s;i++){r=t[i];if(r.subLayerIds){r.subLayers=[];for(var u=0,a=r.subLayerIds.length;u<a;u++){var f=this.getLayer(r.subLayerIds[u]);r.subLayers.push(f);f.parentLayer=r}}}};MapService.prototype.initLegend_=function(e){var t=this.layers;if(e.layers){var n,r,i,s;for(r=0,i=e.layers.length;r<i;r++){s=e.layers[r];n=t[s.layerId];augmentObject_(s,n)}}};MapService.prototype.getLayer=function(e){var t=this.layers;if(t){for(var n=0,r=t.length;n<r;n++){if(e===t[n].id){return t[n]}if(isString_(e)&&t[n].name.toLowerCase()===e.toLowerCase()){return t[n]}}}return null};MapService.prototype.getLayerDefs_=function(){var e={};if(this.layers){for(var t=0,n=this.layers.length;t<n;t++){var r=this.layers[t];if(r.definition){e[String(r.id)]=r.definition}}}return e};MapService.prototype.hasLoaded=function(){return this.loaded_};MapService.prototype.getVisibleLayerIds_=function(){var e=[];if(this.layers){var t;var n,r;for(n=0,r=this.layers.length;n<r;n++){t=this.layers[n];if(t.subLayers){for(var i=0,s=t.subLayers.length;i<s;i++){if(t.subLayers[i].visible===false){t.visible=false;break}}}}for(n=0,r=this.layers.length;n<r;n++){t=this.layers[n];if(t.subLayers&&t.subLayers.length>0){continue}if(t.visible===true){e.push(t.id)}}}return e};MapService.prototype.getInitialBounds=function(){if(this.initialExtent){this.initBounds_=this.initBounds_||fromEnvelopeToLatLngBounds_(this.initialExtent);return this.initBounds_}return null};MapService.prototype.getFullBounds=function(){if(this.fullExtent){this.fullBounds_=this.fullBounds_||fromEnvelopeToLatLngBounds_(this.fullExtent);return this.fullBounds_}return null};MapService.prototype.exportMap=function(e,t,n){if(!e||!e.bounds){return}var r={};r.f=e.f;var i=e.bounds;r.bbox=""+i.getSouthWest().lng()+","+""+i.getSouthWest().lat()+","+i.getNorthEast().lng()+","+""+i.getNorthEast().lat();r.size=""+e.width+","+e.height;r.dpi=e.dpi;if(e.imageSR){if(e.imageSR.wkid){r.imageSR=e.imageSR.wkid}else{r.imageSR="{wkt:"+e.imageSR.wkt+"}"}}r.bboxSR="4326";r.format=e.format;var s=e.layerDefinitions;if(s===undefined){s=this.getLayerDefs_()}r.layerDefs=getLayerDefsString_(s);var o=e.layerIds;var u=e.layerOption||"show";if(o===undefined){o=this.getVisibleLayerIds_()}if(o.length>0){r.layers=u+":"+o.join(",")}else{if(this.loaded_&&t){t({href:null});return}}r.transparent=e.transparent===false?false:true;if(e.time){r.time=formatTimeString_(e.time,e.endTime)}r.layerTimeOptions=e.layerTimeOptions;if(r.f==="image"){return this.url+"/export?"+formatParams_(r)}else{getJSON_(this.url+"/export",r,"",function(e){if(e.extent){e.bounds=fromEnvelopeToLatLngBounds_(e.extent);delete e.extent;t(e)}else{handleErr_(n,e.error)}})}};MapService.prototype.identify=function(e,t,n){if(!e){return}var r={};r.geometry=fromOverlaysToJSON_(e.geometry);r.geometryType=getGeometryType_(e.geometry);r.mapExtent=fromOverlaysToJSON_(e.bounds);r.tolerance=e.tolerance||2;r.sr=4326;r.imageDisplay=""+e.width+","+e.height+","+(e.dpi||96);r.layers=e.layerOption||"all";if(e.layerIds){r.layers+=":"+e.layerIds.join(",")}if(e.layerDefs){r.layerDefs=getLayerDefsString_(e.layerDefs)}r.maxAllowableOffset=e.maxAllowableOffset;r.returnGeometry=e.returnGeometry===false?false:true;getJSON_(this.url+"/identify",r,"",function(r){var i=null;var s,o,u;if(r.results){i=[];for(s=0;s<r.results.length;s++){o=r.results[s];u=fromJSONToOverlays_(o.geometry,e.overlayOptions);o.feature={geometry:u,attributes:o.attributes};delete o.attributes}}t(r);handleErr_(n,r)})};MapService.prototype.find=function(e,t,n){if(!e){return}var r=augmentObject_(e,{});if(e.layerIds){r.layers=e.layerIds.join(",");delete r.layerIds}if(e.searchFields){r.searchFields=e.searchFields.join(",")}r.contains=e.contains===false?false:true;if(e.layerDefinitions){r.layerDefs=getLayerDefsString_(e.layerDefinitions);delete r.layerDefinitions}r.sr=4326;r.returnGeometry=e.returnGeometry===false?false:true;getJSON_(this.url+"/find",r,"",function(r){var i=null;var s,o,u;if(r.results){i=[];for(s=0;s<r.results.length;s++){o=r.results[s];u=fromJSONToOverlays_(o.geometry,e.overlayOptions);o.feature={geometry:u,attributes:o.attributes};delete o.attributes}}t(r);handleErr_(n,r)})};MapService.prototype.queryLayer=function(e,t,n,r){var i=this.getLayer(e);if(i){i.query(t,n,r)}};GeocodeService.prototype.init_=function(e){augmentObject_(e,this);if(e.spatialReference){this.spatialReference=spatialReferences_[e.spatialReference.wkid||e.spatialReference.wkt]||WGS84}this.loaded_=true;triggerEvent_(this,"load")};GeocodeService.prototype.findAddressCandidates=function(e,t,n){var r=augmentObject_(e,{});if(r.inputs){augmentObject_(r.inputs,r);delete r.inputs}if(isArray_(r.outFields)){r.outFields=r.outFields.join(",")}var i=this;getJSON_(this.url+"/findAddressCandidates",r,"",function(r){if(r.candidates){var s,o;var u=[];for(var a=0;a<r.candidates.length;a++){s=r.candidates[a];o=s.location;if(!isNaN(o.x)&&!isNaN(o.y)){var f=[o.x,o.y];var l=i.spatialReference;if(e.outSR){l=spatialReferences_[e.outSR]}if(l)f=l.inverse(f);s.location=new G.LatLng(f[1],f[0]);u[u.length]=s}}}t({candidates:u});handleErr_(n,r)})};GeocodeService.prototype.geocode=function(e,t){this.findAddressCandidates(e,t)};GeocodeService.prototype.reverseGeocode=function(e,t,n){if(!isString_(e.location)){e.location=fromOverlaysToJSON_(e.location)}e.outSR=4326;var r=this;getJSON_(this.url+"/reverseGeocode",e,"",function(e){if(e.location){var i=e.location;if(!isNaN(i.x)&&!isNaN(i.y)){var s=[i.x,i.y];if(r.spatialReference){s=r.spatialReference.inverse(s)}e.location=new G.LatLng(s[1],s[0])}}t(e);handleErr_(n,e)})};GeometryService.prototype.project=function(e,t,n){var r=prepareGeometryParams_(e);getJSON_(this.url+"/project",r,"callback",function(r){var i=[];if(e.outSpatialReference===4326||e.outSpatialReference.wkid===4326){for(var s=0,o=r.geometries.length;s<o;s++){i.push(fromJSONToOverlays_(r.geometries[s]))}r.geometries=i}t(r);handleErr_(n,r)})};var SRUnit={METER:9001,FOOT:9002,SURVEY_FOOT:9003,SURVEY_MILE:9035,KILLOMETER:9036,RADIAN:9101,DEGREE:9102};GeometryService.prototype.buffer=function(e,t,n){var r=prepareGeometryParams_(e);if(e.bufferSpatialReference){r.bufferSR=formatSRParam_(e.bufferSpatialReference)}r.outSR=4326;r.distances=e.distances.join(",");if(e.unit){r.unit=e.unit}getJSON_(this.url+"/buffer",r,"callback",function(r){var i=[];if(r.geometries){for(var s=0,o=r.geometries.length;s<o;s++){i.push(fromJSONToOverlays_(r.geometries[s],e["overlayOptions"]))}}r.geometries=i;t(r);handleErr_(n,r)})};GPTask.prototype.execute=function(e,t,n){var r={};if(e.parameters){augmentObject_(e.parameters,r)}if(e.outSpatialReference){r["env:outSR"]=formatSRParam_(e.outSpatialReference)}else{r["env:outSR"]=4326}if(e.processSpatialReference){r["env:processSR"]=formatSRParam_(e.processSpatialReference)}getJSON_(this.url+"/execute",r,"",function(r){if(r.results){var i,s;for(var o=0;o<r.results.length;o++){i=r.results[o];if(i.dataType==="GPFeatureRecordSetLayer"){for(var u=0,a=i.value.features.length;u<a;u++){s=i.value.features[u];if(s.geometry){s.geometry=fromJSONToOverlays_(s.geometry,e.overlayOptions)}}}}}t(r);handleErr_(n,r)})};RouteTask.prototype.solve=function(e,t,n){if(!e){return}var r=augmentObject_(e,{});if(isArray_(e.stops)){r.stops=fromLatLngsToFeatureSet_(e.stops)}if(isArray_(e.barriers)){if(e.barriers.length>0){r.barriers=fromLatLngsToFeatureSet_(e.barriers)}else{delete r.barriers}}r.returnRoutes=e.returnRoutes===false?false:true;r.returnDirections=e.returnDirections===true?true:false;r.returnBarriers=e.returnBarriers===true?true:false;r.returnStops=e.returnStops===true?true:false;getJSON_(this.url+"/solve",r,"",function(r){if(r.routes){parseFeatures_(r.routes.features,e.overlayOptions)}t(r);handleErr_(n,r)})};Projection.prototype.fromLatLngToPoint=function(e,t){if(!e||isNaN(e.lat())||isNaN(e.lng())){return null}var n=this.spatialReference_.forward([e.lng(),e.lat()]);var r=t||new G.Point(0,0);r.x=(n[0]-this.originX_)/this.scale_;r.y=(this.originY_-n[1])/this.scale_;return r};Projection.prototype["fromLatLngToPoint"]=Projection.prototype.fromLatLngToPoint;Projection.prototype.fromPointToLatLng=function(e,t){if(e===null){return null}var n=e.x*this.scale_+this.originX_;var r=this.originY_-e.y*this.scale_;var i=this.spatialReference_.inverse([n,r]);return new G.LatLng(i[1],i[0])};Projection.prototype.getScale=function(e){var t=e-this.minZoom;var n=0;if(this.lods_[t]){n=this.lods_[t].scale}return n};Projection.WEB_MECATOR=new Projection;TileLayer.prototype.init_=function(e){if(this.mapService_.tileInfo){this.projection_=new Projection(this.mapService_.tileInfo);this.minZoom=e.minZoom||this.projection_.minZoom;this.maxZoom=e.maxZoom||this.projection_.maxZoom}};TileLayer.prototype.getTileUrl=function(e,t){var n=t-(this.projection_?this.projection_.minZoom:this.minZoom);var r="";if(!isNaN(e.x)&&!isNaN(e.y)&&n>=0&&e.x>=0&&e.y>=0){var i=this.mapService_.url;if(this.urlTemplate_){i=this.urlTemplate_.replace("["+this.numOfHosts_+"]",""+(e.y+e.x)%this.numOfHosts_)}var s=this.projection_||(this.map_?this.map_.getProjection():Projection.WEB_MECATOR);if(!s instanceof Projection){s=Projection.WEB_MECATOR}var o=s.tileSize_;var u=1<<t;var a=new G.Point(e.x*o.width/u,(e.y+1)*o.height/u);var f=new G.Point((e.x+1)*o.width/u,e.y*o.height/u);var l=new G.LatLngBounds(s.fromPointToLatLng(a),s.fromPointToLatLng(f));var c=this.mapService_.getFullBounds();if(this.mapService_.singleFusedMapCache===false||t>this.dynaZoom){var h={f:"image"};h.bounds=l;h.format="png32";h.width=o.width;h.height=o.height;h.imageSR=s.spatialReference_;r=this.mapService_.exportMap(h)}else if(c&&!c.intersects(l)){r=""}else{r=i+"/tile/"+n+"/"+e.y+"/"+e.x}}return r};TileLayer.prototype.setOpacity=function(e){this.opacity_=e;var t=this.tiles_;for(var n in t){if(t.hasOwnProperty(n)){setNodeOpacity_(t[n],e)}}};TileLayer.prototype.getOpacity=function(){return this.opacity_};TileLayer.prototype.getMapService=function(){return this.mapService_};MapType.prototype.getTile=function(e,t,n){var r=n.createElement("div");var i="_"+e.x+"_"+e.y+"_"+t;for(var s=0;s<this.tileLayers_.length;s++){var o=this.tileLayers_[s];if(t<=o.maxZoom&&t>=o.minZoom){var u=o.getTileUrl(e,t);if(u){var a=n.createElement(document.all?"img":"div");a.style.border="0px none";a.style.margin="0px";a.style.padding="0px";a.style.overflow="hidden";a.style.position="absolute";a.style.top="0px";a.style.left="0px";a.style.width=""+this.tileSize.width+"px";a.style.height=""+this.tileSize.height+"px";if(document.all){a.src=u}else{a.style.backgroundImage="url("+u+")"}r.appendChild(a);o.tiles_[i]=a;if(o.opacity_!==undefined){setNodeOpacity_(a,o.opacity_)}else if(this.opacity_!==undefined){setNodeOpacity_(a,this.opacity_)}}else{}}}this.tiles_[i]=r;r.setAttribute("tid",i);return r};MapType.prototype["getTile"]=MapType.prototype.getTile;MapType.prototype.releaseTile=function(e){if(e.getAttribute("tid")){var t=e.getAttribute("tid");if(this.tiles_[t]){delete this.tiles_[t]}for(var n=0;n<this.tileLayers_.length;n++){var r=this.tileLayers_[n];if(r.tiles_[t]){delete r.tiles_[t]}}}};MapType.prototype["releaseTile"]=MapType.prototype.releaseTile;MapType.prototype.setOpacity=function(e){this.opacity_=e;var t=this.tiles_;for(var n in t){if(t.hasOwnProperty(n)){var r=t[n].childNodes;for(var i=0;i<r.length;i++){setNodeOpacity_(r[i],e)}}}};MapType.prototype.getOpacity=function(){return this.opacity_};MapType.prototype.getTileLayers=function(){return this.tileLayers_};MapOverlay.prototype=new G.OverlayView;MapOverlay.prototype.onAdd=function(){var e=this;this.listeners_.push(G.event.addListener(this.getMap(),"bounds_changed",callback_(this.refresh,this)));this.listeners_.push(G.event.addListener(this.getMap(),"dragstart",function(){e.dragging=true}));this.listeners_.push(G.event.addListener(this.getMap(),"dragend",function(){e.dragging=false}));var t=this.getMap();t.agsOverlays=t.agsOverlays||new G.MVCArray;t.agsOverlays.push(this);setCopyrightInfo_(t);this.map_=t};MapOverlay.prototype["onAdd"]=MapOverlay.prototype.onAdd;MapOverlay.prototype.onRemove=function(){for(var e=0,t=this.listeners_.length;e<t;e++){G.event.removeListener(this.listeners_[e])}if(this.overlay_)this.overlay_.setMap(null);var n=this.map_;var r=n.agsOverlays;if(r){for(var e=0,i=r.getLength();e<i;e++){if(r.getAt(e)==this){r.removeAt(e);break}}}setCopyrightInfo_(n);this.map_=null};MapOverlay.prototype["onRemove"]=MapOverlay.prototype.onRemove;MapOverlay.prototype.draw=function(){if(!this.drawing_||this.needsNewRefresh_===true){this.refresh()}};MapOverlay.prototype["draw"]=MapOverlay.prototype.draw;MapOverlay.prototype.getOpacity=function(){return this.opacity_};MapOverlay.prototype.setOpacity=function(e){var t=Math.min(Math.max(e,0),1);this.opacity_=t;if(this.overlay_){setNodeOpacity_(this.overlay_.div_,t)}};MapOverlay.prototype.getMapService=function(){return this.mapService_};MapOverlay.prototype.refresh=function(){if(this.drawing_===true){this.needsNewRefresh_=true;return}var e=this.getMap();var t=e?e.getBounds():null;if(!t){return}var n=this.exportOptions_;n.bounds=t;var r=WEB_MERCATOR;var i=e.getDiv();n.width=i.offsetWidth;n.height=i.offsetHeight;if(i.offsetWidth==0||i.offsetHeight==0){return}var s=e.getProjection();if(s&&s instanceof Projection){r=s.spatialReference_}n.imageSR=r;triggerEvent_(this,"drawstart");var o=this;this.drawing_=true;if(!this.dragging&&this.overlay_){this.overlay_.setMap(null);this.overlay_=null}this.mapService_.exportMap(n,function(e){o.drawing_=false;if(o.needsNewRefresh_===true){o.needsNewRefresh_=false;o.refresh();return}if(e.href){if(o.overlay_){o.overlay_.setMap(null);o.overlay_=null}o.overlay_=new ImageOverlay(e.bounds,e.href,o.map_,o.opacity_)}triggerEvent_(o,"drawend")})};MapOverlay.prototype.isHidden=function(){return!(this.visible_&&this.isInZoomRange_())};MapOverlay.prototype.isInZoomRange_=function(){var e=this.getMap().getZoom();if(this.minZoom!==undefined&&e<this.minZoom||this.maxZoom!==undefined&&e>this.maxZoom){return false}return true};MapOverlay.prototype.show=function(){this.visible_=true;this.div_.style.visibility="visible";this.refresh()};MapOverlay.prototype.hide=function(){this.visible_=false;this.div_.style.visibility="hidden"};ImageOverlay.prototype=new G.OverlayView;ImageOverlay.prototype.onAdd=function(){var e=document.createElement("DIV");e.style.border="none";e.style.borderWidth="0px";e.style.position="absolute";e.style.backgroundImage="url("+this.url_+")";this.div_=e;var t=this.getPanes();setNodeOpacity_(e,this.op_);t.overlayLayer.appendChild(e)};ImageOverlay.prototype.draw=function(){var e=this.getProjection();var t=e.fromLatLngToDivPixel(this.bounds_.getSouthWest());var n=e.fromLatLngToDivPixel(this.bounds_.getNorthEast());var r=this.div_;r.style.left=t.x+"px";r.style.top=n.y+"px";r.style.width=n.x-t.x+"px";r.style.height=t.y-n.y+"px"};ImageOverlay.prototype.onRemove=function(){this.div_.parentNode.removeChild(this.div_);this.div_=null};CopyrightControl.prototype.refresh=function(){setCopyrightInfo_(this.map_)};gmaps.ags={SpatialReference:SpatialReference,Geographic:Geographic,LambertConformalConic:LambertConformalConic,SphereMercator:SphereMercator,TransverseMercator:TransverseMercator,SpatialRelationship:SpatialRelationship,GeometryType:GeometryType,SRUnit:SRUnit,Catalog:Catalog,MapService:MapService,Layer:Layer,GeocodeService:GeocodeService,GeometryService:GeometryService,GPService:GPService,GPTask:GPTask,RouteTask:RouteTask,Util:Util,Config:Config,Projection:Projection,TileLayer:TileLayer,MapOverlay:MapOverlay,MapType:MapType,CopyrightControl:CopyrightControl};window.gmaps=gmaps})()

